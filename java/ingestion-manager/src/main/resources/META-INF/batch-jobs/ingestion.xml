<job id="ingestion" xmlns="http://xmlns.jcp.org/xml/ns/javaee" version="1.0">
    <step id="load">
        <batchlet ref="httpFileDownloader">
            <properties>
                <property name="download.url" value="#{jobParameters['download.url']}"/>
                <property name="download.chunk.size" value="#{jobParameters['download.chunk.size']}"/>
            </properties>
        </batchlet>
        <next on="COMPLETE" to="extract" />
    </step>
    <step id="extract">
        <batchlet ref="tarGZExtractor">
            <properties>
                <property name="tar.gz.path" value="#{jobParameters['tar.gz.path']}"/>
            </properties>
        </batchlet>
        <next on="COMPLETE" to="ingest" />
    </step>
    <step id="ingest">
        <chunk item-count="100000">
            <reader ref="mailReader" />
            <writer ref="ingestor" />
        </chunk>
    </step>
</job>